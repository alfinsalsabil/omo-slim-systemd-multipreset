# =========================================================================
# CLOUDFLARE TUNNEL SSE FIX (config-snippet.yml)
# =========================================================================
# The biggest mistake people make when setting up Cloudflare Tunnels
# with OpenCode is adding `disableChunkedEncoding: true` or `http2Origin: true`.
# 
# OpenCode uses HTTP/1.1 for its internal server. If you force HTTP/2
# or disable chunked encoding, your AI typing stream will break or 502!
#
# Your ingress rules should be perfectly clean like this:

ingress:
  # Example for preset Maks (Port 4001)
  - hostname: maks-oc.yourdomain.com
    service: http://127.0.0.1:4001

  # Example for preset Mid (Port 4002)
  - hostname: mid-oc.yourdomain.com
    service: http://127.0.0.1:4002

  # Example for preset Low (Port 4003)
  - hostname: low-oc.yourdomain.com
    service: http://127.0.0.1:4003

  # Mandatory catch-all
  - service: http_status:404
